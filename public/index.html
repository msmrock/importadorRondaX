<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ronda Senior X</title>
    <link
      rel="icon"
      type="image/x-icon"
      href="./image/favicon.ico"
      alt="Favicon do site Ronda Senior X"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .btn-width {
        width: 200px;
      }
    </style>
  </head>
  <body class="bg-green-250 flex items-center justify-center min-h-screen p-4">
    <a href="#mainContent" class="sr-only focus:not-sr-only"
      >Pular para o conteúdo principal</a
    >

    <!-- Sobreposição de carregamento -->
    <div
      id="loadingOverlay"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"
      role="dialog"
      aria-label="Tela de carregamento"
    >
      <div class="bg-white p-6 rounded-lg shadow-xl text-center">
        <div
          class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"
          aria-hidden="true"
        ></div>
        <p class="text-lg font-semibold text-gray-700">Processando...</p>
        <p class="text-sm text-gray-500 mt-2">Por favor, aguarde.</p>
      </div>
    </div>

    <main
      id="mainContent"
      class="w-full max-w-3xl bg-gray-100 rounded-lg shadow-lg p-2 space-y-2"
    >
      <h1 class="text-3xl font-bold text-center text-gray-800">
        Ronda Senior X - Importador
      </h1>

      <!-- Formulário de Login -->
      <div id="loginForm">
        <form class="space-y-6" onsubmit="handleLogin(event)">
          <div class="flex justify-center">
            <div class="w-96">
              <label
                for="username"
                class="block text-sm font-medium text-gray-700"
                >Usuário</label
              >
              <input
                id="username"
                name="username"
                type="text"
                required
                placeholder="usuario@tenant"
                class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
              />
            </div>
          </div>
          <div class="flex justify-center">
            <div class="w-96">
              <label
                for="password"
                class="block text-sm font-medium text-gray-700"
                >Senha</label
              >
              <input
                id="password"
                name="password"
                type="password"
                required
                class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
              />
            </div>
          </div>
          <button
            type="submit"
            class="btn-width mx-auto flex justify-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-black hover:bg-red-700 transition mt-4"
          >
            Entrar
          </button>
        </form>
      </div>

      <div class="footer">
        <span style="color: black"><i>Logado - ${username}</i></span>
        <br/> 
         <span style="color: black"><i>Created by Mainardes</i></span>
      </div>

      <div
        id="uploadForm"
        class="hidden w-full mx-auto p-2 bg-white rounded-xl shadow-2xl"
      >
            <!-- BT PRINCIPAL: -->
            <div class="flex justify-center items-center gap-4 w-full h-4">
              <!-- GT: -->
              <button
                onclick="navigateToTerceiros()"
                class="btn-width flex justify-center items-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition mt-4"
              >
                Gestão de Terceiros
              </button>
              <!-- GT: -->
      
              <!-- NIVEL: -->
              <button
                onclick="resetPersonLevel()"
                class="btn-width flex justify-center items-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition mt-4"
              >
                Reiniciar Nivel
              </button>
              <!-- NIVEL: -->
      
              <!-- Proprietaria: -->
              <button
                onclick="getLicenseInfo()"
                class="btn-width flex justify-center items-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition mt-4"
              >
                Proprietaria
              </button>
              <!-- Proprietaria: -->

              <!-- SAIR: -->
              <button
              onclick="handleLogout()"
              class="btn-width mx-auto flex justify-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition mt-4"
            >
              Sair
            </button>
            <!-- SAIR: -->
            </div>
            <!-- BT PRINCIPAL: -->
            <br />
        <h2 class="text-1xl font-bold text-center text-gray-800">
          Importação de pessoas para o Ronda Senior X X
        </h2>
        <p class="text-center text-lg text-gray-600">
          Arquivo CSV deve conter os campos abaixo
        </p>
        <form class="space-y-6" onsubmit="handleUpload(event)">
          <div>
            <label
              for="csvFile"
              class="block text-sm text-center font-medium text-gray-700 break-words"
            >
              <style>
                table {
                  border-collapse: collapse;
                  width: 100%;
                }
                th,
                td {
                  border: 1px solid green;
                  padding: 8px;
                  text-align: left;
                }
                th {
                  background-color: #f2f2f2;
                }
                .red {
                  color: red;
                }
                .small-text {
                  font-size: 11px;
                }
              </style>

              <table>
                <tr>
                  <th>Campos</th>
                </tr>
                <tr>
                  <td class="small-text">
                    <span class="red">name</span> |
                    <span class="red">cpf</span> | gender |
                    <span class="red">roleId</span> |
                    <span class="red">cardNumber</span> |
                    <span class="red">cardTechnology</span> | expirationDate |
                    <span class="red">organizationalStructure1</span> | email |
                    registry
                  </td>
                </tr>
              </table>
            </label>
            <input
              id="csvFile"
              name="csvFile"
              type="file"
              accept=".csv"
              required
              class="mt-2 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-green-500 focus:border-green-500"
            />
            
            <div class="flex justify-start mt-2">
              <button
                type="submit"
                class="btn-width flex justify-center py-1 px-3 rounded-sm shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 transition"
              >
                Processar Arquivo
              </button>
            </div>


          </div>

        </form>
        <br />

        <div>
          <p class="text-center text-base">
            <strong class="font-mono">Detalhes dos campos</strong> -
            <span class="text-black">
              Obs: Dados em
              <span class="font-mono text-red-500">vermelho</span> são
              obrigatórios.
            </span>
          </p>

          <style>
            table {
              border-collapse: collapse;
              width: 100%;
              font-size: 12px; /* Fonte menor */
            }
            th,
            td {
              border: 1px solid green;
              padding: 3px 6px; /* Reduzido para diminuir altura */
              text-align: left;
              line-height: 1.2; /* Ajuste da altura da linha */
            }
            th {
              background-color: #f2f2f2;
              font-size: 13px; /* Leve destaque */
              padding: 4px 6px;
            }
            .red {
              color: red;
            }
            .footer {
              margin-top: 10px;
              font-family: Georgia, serif;
              font-size: 14px;
              font-style: italic;
              font-weight: bold;
              text-align: center;
            }
          </style>

          <table>
            <tr>
              <th><span class="red">Campo</span></th>
              <th>Descrição</th>
            </tr>
            <tr>
              <td><span class="red">name</span></td>
              <td>Nome</td>
            </tr>
            <tr>
              <td><span class="red">cpf</span></td>
              <td>CPF - Cadastro de Pessoa Física</td>
            </tr>
            <tr>
              <td>gender</td>
              <td>Sexo (0 = Vazio, 1 = Masculino, 2 = Feminino)</td>
            </tr>
            <tr>
              <td><span class="red">roleId</span></td>
              <td>ID do papel cadastrado no sistema</td>
            </tr>
            <tr>
              <td><span class="red">cardNumber</span></td>
              <td>Número físico do crachá</td>
            </tr>
            <tr>
              <td><span class="red">cardTechnology</span></td>
              <td>(1 = Barras, 2 = Proximidade, 3 = SmartCard)</td>
            </tr>
            <tr>
              <td>expirationDate</td>
              <td>Data final do crachá</td>
            </tr>
            <tr>
              <td><span class="red">organizationalStructure1</span></td>
              <td>ID da estrutura cadastrada no sistema</td>
            </tr>
            <tr>
              <td>email</td>
              <td>E-mail válido</td>
            </tr>
            <tr>
              <td>registry</td>
              <td>Matrícula</td>
            </tr>
          </table>

          <br />
        </div>
      </div>

      <!-- Seção de Resultados -->
      <div id="results" class="hidden" aria-live="polite">
        <h2 class="text-xl font-bold text-gray-800">
          Resultados do Processamento
        </h2>
        <div id="resultsContent" class="space-y-4"></div>
        <button
          onclick="downloadResults()"
          class="w-full flex justify-center py-2 px-4 rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 transition"
        >
          Download do Relatório
        </button>
        <button
          onclick="resetUpload()"
          class="w-full flex justify-center py-2 px-4 rounded-md shadow-sm text-sm font-medium text-white bg-gray-600 hover:bg-gray-700 transition"
        >
          Novo Upload
        </button>
      </div>
    </main>

    <script src="js/main.js"></script>
  </body>
</html>
